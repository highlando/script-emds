# Matrix-Zerlegungen

Die L&ouml;sung $w$ des Problems der *linearen Ausgleichsrechnung* war entweder als L&ouml;sung eines Optimierungsproblems
\begin{equation*}
\min_{w} \| Aw - y \|^2
\end{equation*}
oder als L&ouml;sung des linearen Gleichungssystems
\begin{equation*}
A^TAw=y
\end{equation*}
gegeben. Hierbei steht nun $A\in \mathbb R^{N\times n}$ f&uuml;r die Matrix $\Phi(\mathbf x)$ der Daten und Basisfunktionen. Wir hatten uns &uuml;berlegt, dass in den meisten F&auml;llen

 * die Matrix mehr Zeilen als Spalten hat ($N>n$) und
 * die Spalten linear unabh&auml;ngig sind.

## QR Zerlegung

Wir betrachten nochmal das Optimierungsproblem $\min_{w} \| Aw - y \|^2$. G&auml;be es eine L&ouml;sung des Systems $Aw=y$, w&auml;re das sofort eine L&ouml;sung des Optimierungsproblems. Da $A$ aber mehr Zeilen als Spalten hat, ist das System $Aw=y$ &uuml;berbestimmt und eine L&ouml;sung in der Regel nicht gegeben.

Die &Uuml;berlegung ist nun, die Gleichung $Aw=y$ *so gut wie m&ouml;glich* zu erf&uuml;llen, indem wir die relevanten Gleichungen indentifizieren und wenigstens diese l&ouml;sen. Ein systematischer (und wie wir sp&auml;ter sehen werden auch zum Optimierungsproblem passender) Zugang bietet die QR Zerlegung.

::: {.theorem name="QR Zerlegung" #qr}
Sei $A\mathbb R^{m\times n}$, $m>n$. Dann existiert eine orthonormale Matrix $Q\in \mathbb R^{m\times m}$ und eine obere Dreiecksmatrix $\hat R\in \mathbb R^{n\times n}$ derart dass
\begin{equation*}
A = QR =: Q 
\begin{bmatrix}
\hat R \\ 0
\end{bmatrix}.
\end{equation*}
Hat $A$ vollen (Spalten)Rang, dann ist $\hat R$ invertierbar.
:::

Hier hei&szlig;t *orthonormale Matrix* $Q$, dass die Spalten von $Q$ paarweise orthogonal sind. Insbesondere gilt 
\begin{equation*}
Q^T Q = I.
\end{equation*}

F&uuml;r unser zu l&ouml;sendes Problem ergibt sich dadurch die Umformung
\begin{equation*}
Aw = y \quad \Leftrightarrow \quad QRw=y \quad \Leftrightarrow \quad Q^TQRw=Q^T y 
 \quad \Leftrightarrow \quad  Rw = Q^Ty
\end{equation*}
oder auch
\begin{equation*}
\begin{bmatrix}
\hat R \\ 0
\end{bmatrix}w 
=
Q^Ty
=
\begin{bmatrix}
Q_1^T \\ Q_2^T
\end{bmatrix}
y
\end{equation*}
(wobei wir die $Q_1\in \mathbb R^{m\times n}$ die Matrix der ersten $n$ Spalten von $Q$ ist)
und als *Kompromiss* der Vorschlag, das Teilsystem
\begin{equation*}
\hat R w = Q_1^Ty
\end{equation*}
nach $w$ zu l&ouml;sen und in Kauf zu nehmen, dass der Rest, n&auml;mlich das $Q_2^Ty$, nicht notwendigerweise gleich null ist.

Wir halten zun&auml;chst mal fest, dass

* Obwohl $Q$ eine regul&auml;re Matrix ist, bedarf der &Uuml;bergang von $Aw=y$ zu $Q^TAw=Q^Ty$ einer genaueren Analyse. 
* Wir bemerken, dass f&uuml;r eine hypothetische komplette L&ouml;sung $Aw-y$, diese Transformation keine Rolle spielt.
* F&uuml;r die Kompromissl&ouml;sung jedoch schon, weil beispielsweise verschiedene Konstruktionen eines invertierbaren Teils, verschiedene Residuen bedeuten und somit Optimalit&auml;t im Sinne von $\min_w \|Aw-y\|^2$ nicht garantiert ist.

Allerdings, wie Sie als &Uuml;bungsaufgabe nachweisen werden, l&ouml;st dieser Ansatz tats&auml;chlich das Optimierungsproblem.

## Aufgaben

### (T) Norm und Orthogonale Transformation

Sei $Q\in \mathbb R^{n\times n}$ eine orthogonale Matrix und sei $y\in \mathbb R^{n}$. Zeigen Sie, dass
\begin{equation*}
\|y\|^2 = \|Qy \|^2
\end{equation*}
gilt. 

### (T) QR Zerlegung und Kleinstes Quadrate Problem

Sei $A\in \mathbb R^{m,n}$, $m>n$, $A$ hat vollen Rank und sei
\begin{equation*}
\begin{bmatrix}
Q_1 & Q_2
\end{bmatrix}
\begin{bmatrix}
\hat R \\ 0
\end{bmatrix} = A
\end{equation*}
eine QR-Zerlegung von $A$. Zeigen sie, dass die L&ouml;sung 
